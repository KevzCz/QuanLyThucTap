@startuml Activity - Yêu cầu chat hỗ trợ

skinparam ActivityDiagramTitleFontSize 16
skinparam swimlaneWidth same

|#LightBlue|Người yêu cầu|
start

:Truy cập trang chat hỗ trợ;

note right: Có thể là sinh viên,\ngiảng viên, hoặc BCN

:Nhấn nút "Tạo yêu cầu mới";

:Chọn người nhận hỗ trợ\n(hoặc để trống cho tự động);

:Nhập tiêu đề yêu cầu;

:Nhập nội dung chi tiết\nvấn đề cần hỗ trợ;

:Xác nhận gửi yêu cầu;

|#LightGreen|Hệ thống|

:Kiểm tra tính hợp lệ\ncủa dữ liệu;

if (Dữ liệu có hợp lệ?) then (Hợp lệ)
  
  if (Có chỉ định người nhận?) then (Có)
    
    :Tạo yêu cầu chat\ncho người được chỉ định;
    
    :Gửi thông báo đến\nngười nhận cụ thể;
    
  else (Không)
    
    :Tạo yêu cầu chat chung;
    
    :Gửi thông báo đến\nvai trò phù hợp xử lý;
    
  endif
  
  |#LightBlue|Người yêu cầu|
  
  :Hiển thị thông báo thành công;
  
  :Chờ phản hồi từ người hỗ trợ;
  
  |#LightYellow|Người hỗ trợ|
  
  :Nhận thông báo yêu cầu mới;
  
  :Xem chi tiết yêu cầu chat;
  
  if (Quyết định xử lý?) then (Chấp nhận)
    
    :Chấp nhận yêu cầu hỗ trợ;
    
    |#LightGreen|Hệ thống|
    
    :Tạo phòng chat riêng;
    
    :Cập nhật trạng thái\nyêu cầu thành "Đang xử lý";
    
    :Gửi thông báo cho\nngười yêu cầu;
    
    |#LightBlue|Người yêu cầu|
    
    :Bắt đầu cuộc trò chuyện\ntrực tiếp;
    
    note right: Có thể trao đổi\nrealtime qua chat
    
    stop
    
  else (Từ chối)
    
    :Từ chối yêu cầu với lý do;
    
    |#LightGreen|Hệ thống|
    
    :Cập nhật trạng thái\nyêu cầu thành "Bị từ chối";
    
    :Gửi thông báo kèm lý do\ncho người yêu cầu;
    
    |#LightBlue|Người yêu cầu|
    
    :Nhận thông báo từ chối\nvà lý do;
    
    stop
    
  endif
  
else (Không hợp lệ)
  
  |#LightBlue|Người yêu cầu|
  
  :Hiển thị lỗi validation;
  
  stop
  
endif

@enduml
